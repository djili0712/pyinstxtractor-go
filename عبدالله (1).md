# -*- coding: utf-8 -*-
import tkinter as tk
from tkinter import ttk, messagebox
import json
import os
from datetime import datetime, timedelta
from PIL import Image, ImageTk
import calendar

class ูุฏูุฑ_ุงูุงุดุชุฑุงูุงุช_ุงููุญุณู:
    def __init__(self, ูุงูุฐุฉ):
        self.ูุงูุฐุฉ = ูุงูุฐุฉ
        self.ูุงูุฐุฉ.title("๐ ูุฏูุฑ ุงูุงุดุชุฑุงูุงุช - ูุธุงู ูุชุงุจุนุฉ ุงูุฏูุน")
        self.ูุงูุฐุฉ.geometry("1200x800")
        
        # ุฌุนู ุงููุงูุฐุฉ ูู ุงูููุชุตู
        self.ูุงูุฐุฉ.eval('tk::PlaceWindow . center')
        
        # ููู ุญูุธ ุงูุจูุงูุงุช
        self.ููู_ุงูุจูุงูุงุช = "ุงุดุชุฑุงูุงุช_ูุฏููุนุฉ.json"
        
        # ุชุญููู ุงูุจูุงูุงุช
        self.ุงูุจูุงูุงุช = self.ุชุญููู_ุงูุจูุงูุงุช()
        
        # ุฅุนุฏุงุฏ ุงูุณูุงุช ูุงูุฃููุงู
        self.ุฅุนุฏุงุฏ_ุงูุณูุงุช()
        
        # ุฅูุดุงุก ุงููุงุฌูุฉ
        self.ุฅูุดุงุก_ุงููุงุฌูุฉ()
        self.ุชุญุฏูุซ_ุงููุงุฆูุฉ()

    def ุฅุนุฏุงุฏ_ุงูุณูุงุช(self):
        """ุฅุนุฏุงุฏ ุงูุณูุงุช ูุงูุฃููุงู ููุชุทุจูู"""
        self.ุฃููุงู = {
            'ูุดุท': '#e8f5e8',
            'ูุฑูุจ': '#fff8e1', 
            'ุนุงุฌู': '#fff3e0',
            'ูุชุฃุฎุฑ': '#ffebee',
            'ุชู_ุงูุฏูุน': '#f0f8ff',
            'ุฑุฆูุณู': '#2c3e50',
            'ุซุงููู': '#3498db'
        }

    def ุฅูุดุงุก_ุงููุงุฌูุฉ(self):
        """ุฅูุดุงุก ูุงุฌูุฉ ุงููุณุชุฎุฏู ูุน ุชุฑููุฒ ุนูู ุชุงุฑูุฎ ุงูุฏูุน"""
        # ุงูุฅุทุงุฑ ุงูุฑุฆูุณู
        self.ุฅุทุงุฑ_ุฑุฆูุณู = ttk.Frame(self.ูุงูุฐุฉ, padding=15)
        self.ุฅุทุงุฑ_ุฑุฆูุณู.pack(fill="both", expand=True)
        
        # ุงูุนููุงู ุงูุฑุฆูุณู
        ุนููุงู = ttk.Label(self.ุฅุทุงุฑ_ุฑุฆูุณู, 
                         text="๐ ูุธุงู ูุชุงุจุนุฉ ุงุดุชุฑุงูุงุช ุงูุฏูุน", 
                         font=('Arial', 22, 'bold'),
                         foreground=self.ุฃููุงู['ุฑุฆูุณู'])
        ุนููุงู.pack(pady=15)
        
        # ุฅุทุงุฑ ุฅุฏุฎุงู ุงูุจูุงูุงุช ูุน ุชุฑููุฒ ุนูู ุชุงุฑูุฎ ุงูุฏูุน
        self.ุฅูุดุงุก_ุฅุทุงุฑ_ุฅุฏุฎุงู_ุงูุฏูุน()
        
        # ุฅุทุงุฑ ุงูุฅุญุตุงุฆูุงุช ุงููุงููุฉ
        self.ุฅูุดุงุก_ุฅุทุงุฑ_ุงูุฅุญุตุงุฆูุงุช_ุงููุงููุฉ()
        
        # ุฅุทุงุฑ ูุงุฆูุฉ ุงูุงุดุชุฑุงูุงุช
        self.ุฅูุดุงุก_ุฅุทุงุฑ_ูุงุฆูุฉ_ุงูุงุดุชุฑุงูุงุช()
        
        # ุฅุทุงุฑ ุชูููู ุงููุฏููุนุงุช
        self.ุฅูุดุงุก_ุฅุทุงุฑ_ุชูููู_ุงููุฏููุนุงุช()

    def ุฅูุดุงุก_ุฅุทุงุฑ_ุฅุฏุฎุงู_ุงูุฏูุน(self):
        """ุฅูุดุงุก ุฅุทุงุฑ ุฅุฏุฎุงู ุจูุงูุงุช ุงูุฏูุน"""
        ุฅุทุงุฑ_ุฅุฏุฎุงู = ttk.LabelFrame(self.ุฅุทุงุฑ_ุฑุฆูุณู, 
                                   text="๐ณ ุชุณุฌูู ุจูุงูุงุช ุงูุฏูุน ุงูุฃุณุงุณูุฉ", 
                                   padding=20)
        ุฅุทุงุฑ_ุฅุฏุฎุงู.pack(fill="x", pady=15, padx=10)
        
        # ุตู 1: ุงููุนูููุงุช ุงูุฃุณุงุณูุฉ
        ุตู1 = ttk.Frame(ุฅุทุงุฑ_ุฅุฏุฎุงู)
        ุตู1.pack(fill="x", pady=8)
        
        ttk.Label(ุตู1, text="ุงุณู ุงูุงุดุชุฑุงู *:", font=('Arial', 10, 'bold')).grid(row=0, column=0, sticky='w', padx=5)
        self.ูุฏุฎู_ุงูุงุณู = ttk.Entry(ุตู1, width=25, font=('Arial', 10))
        self.ูุฏุฎู_ุงูุงุณู.grid(row=0, column=1, padx=5)
        self.ูุฏุฎู_ุงูุงุณู.bind('<Return>', lambda e: self.ูุฏุฎู_ุงูุณุนุฑ.focus())
        
        ttk.Label(ุตู1, text="ุงูุณุนุฑ ุงูุดูุฑู *:", font=('Arial', 10, 'bold')).grid(row=0, column=2, sticky='w', padx=5)
        self.ูุฏุฎู_ุงูุณุนุฑ = ttk.Entry(ุตู1, width=15, font=('Arial', 10))
        self.ูุฏุฎู_ุงูุณุนุฑ.grid(row=0, column=3, padx=5)
        self.ูุฏุฎู_ุงูุณุนุฑ.bind('<Return>', lambda e: self.ูุฏุฎู_ุชุงุฑูุฎ_ุงูุฏูุน.focus())
        
        # ุตู 2: ุชูุงุฑูุฎ ุงูุฏูุน (ุงูุฃุณุงุณูุฉ)
        ุตู2 = ttk.Frame(ุฅุทุงุฑ_ุฅุฏุฎุงู)
        ุตู2.pack(fill="x", pady=8)
        
        ttk.Label(ุตู2, text="ุชุงุฑูุฎ ุงูุฏูุน ุงูุฃุฎูุฑ *:", font=('Arial', 10, 'bold')).grid(row=0, column=0, sticky='w', padx=5)
        self.ูุฏุฎู_ุชุงุฑูุฎ_ุงูุฏูุน = ttk.Entry(ุตู2, width=15, font=('Arial', 10))
        self.ูุฏุฎู_ุชุงุฑูุฎ_ุงูุฏูุน.grid(row=0, column=1, padx=5)
        self.ูุฏุฎู_ุชุงุฑูุฎ_ุงูุฏูุน.insert(0, datetime.now().strftime('%Y-%m-%d'))
        
        ttk.Label(ุตู2, text="(YYYY-MM-DD)", font=('Arial', 8), foreground='gray').grid(row=0, column=2, sticky='w')
        
        ttk.Label(ุตู2, text="ุฏูุฑุฉ ุงูุฏูุน:", font=('Arial', 10, 'bold')).grid(row=0, column=3, sticky='w', padx=5)
        self.ูุงุฆูุฉ_ุฏูุฑุฉ_ุงูุฏูุน = ttk.Combobox(ุตู2, width=12, values=["ุดูุฑู", "ุฑุจุน ุณููู", "ูุตู ุณููู", "ุณููู"], state="readonly")
        self.ูุงุฆูุฉ_ุฏูุฑุฉ_ุงูุฏูุน.set("ุดูุฑู")
        self.ูุงุฆูุฉ_ุฏูุฑุฉ_ุงูุฏูุน.grid(row=0, column=4, padx=5)
        
        # ุตู 3: ูุนูููุงุช ุฅุถุงููุฉ
        ุตู3 = ttk.Frame(ุฅุทุงุฑ_ุฅุฏุฎุงู)
        ุตู3.pack(fill="x", pady=8)
        
        ttk.Label(ุตู3, text="ุทุฑููุฉ ุงูุฏูุน:", font=('Arial', 10, 'bold')).grid(row=0, column=0, sticky='w', padx=5)
        self.ูุงุฆูุฉ_ุทุฑููุฉ_ุงูุฏูุน = ttk.Combobox(ุตู3, width=15, values=["ุจุทุงูุฉ ุงุฆุชูุงู", "ุชุญููู ุจููู", "PayPal", "ููุฏู", "ุฃุฎุฑู"], state="readonly")
        self.ูุงุฆูุฉ_ุทุฑููุฉ_ุงูุฏูุน.set("ุจุทุงูุฉ ุงุฆุชูุงู")
        self.ูุงุฆูุฉ_ุทุฑููุฉ_ุงูุฏูุน.grid(row=0, column=1, padx=5)
        
        ttk.Label(ุตู3, text="ุงููุฆุฉ:", font=('Arial', 10, 'bold')).grid(row=0, column=2, sticky='w', padx=5)
        self.ูุงุฆูุฉ_ุงููุฆุฉ = ttk.Combobox(ุตู3, width=12, values=["ุชุฑููู", "ุชุนููู", "ุฃุนูุงู", "ุชุณูู", "ุจุฑุงูุฌ", "ุฃุฎุฑู"], state="readonly")
        self.ูุงุฆูุฉ_ุงููุฆุฉ.set("ุชุฑููู")
        self.ูุงุฆูุฉ_ุงููุฆุฉ.grid(row=0, column=3, padx=5)
        
        # ุตู 4: ุงูููุงุญุธุงุช
        ุตู4 = ttk.Frame(ุฅุทุงุฑ_ุฅุฏุฎุงู)
        ุตู4.pack(fill="x", pady=8)
        
        ttk.Label(ุตู4, text="ููุงุญุธุงุช ุงูุฏูุน:", font=('Arial', 10, 'bold')).grid(row=0, column=0, sticky='nw', padx=5)
        self.ูุฏุฎู_ุงูููุงุญุธุงุช = tk.Text(ุตู4, width=60, height=3, font=('Arial', 10))
        self.ูุฏุฎู_ุงูููุงุญุธุงุช.grid(row=0, column=1, columnspan=4, padx=5, sticky='ew')
        
        # ุฃุฒุฑุงุฑ ุงูุชุญูู
        self.ุฅูุดุงุก_ุฃุฒุฑุงุฑ_ุงูุชุญูู(ุฅุทุงุฑ_ุฅุฏุฎุงู)

    def ุฅูุดุงุก_ุฃุฒุฑุงุฑ_ุงูุชุญูู(self, parent):
        """ุฅูุดุงุก ุฃุฒุฑุงุฑ ุงูุชุญูู ุงูุฎุงุตุฉ ุจูุธุงู ุงูุฏูุน"""
        ุฅุทุงุฑ_ุฃุฒุฑุงุฑ = ttk.Frame(parent)
        ุฅุทุงุฑ_ุฃุฒุฑุงุฑ.pack(pady=15)
        
        ttk.Button(ุฅุทุงุฑ_ุฃุฒุฑุงุฑ, 
                  text="๐ณ ุชุณุฌูู ุงูุฏูุน", 
                  command=self.ุชุณุฌูู_ุฏูุน_ุฌุฏูุฏ).pack(side=tk.LEFT, padx=8)
        
        ttk.Button(ุฅุทุงุฑ_ุฃุฒุฑุงุฑ, 
                  text="โ ุชุฃููุฏ ุงูุฏูุน", 
                  command=self.ุชุฃููุฏ_ุงูุฏูุน).pack(side=tk.LEFT, padx=8)
        
        ttk.Button(ุฅุทุงุฑ_ุฃุฒุฑุงุฑ, 
                  text="โ๏ธ ุชุนุฏูู ุงูุฏูุน", 
                  command=self.ุชุนุฏูู_ุฏูุน).pack(side=tk.LEFT, padx=8)
        
        ttk.Button(ุฅุทุงุฑ_ุฃุฒุฑุงุฑ, 
                  text="๐ ุชูุฑูุฑ ุงููุฏููุนุงุช", 
                  command=self.ุนุฑุถ_ุชูุฑูุฑ_ุงูุฏูุน).pack(side=tk.LEFT, padx=8)
        
        ttk.Button(ุฅุทุงุฑ_ุฃุฒุฑุงุฑ, 
                  text="๐ ุชุญุฏูุซ", 
                  command=self.ุชุญุฏูุซ_ุงููุงุฆูุฉ).pack(side=tk.LEFT, padx=8)
        
        ttk.Button(ุฅุทุงุฑ_ุฃุฒุฑุงุฑ,
                  text="๐๏ธ ุญุฐู ูุฎุชุงุฑ",
                  command=self.ุญุฐู_ุงุดุชุฑุงู).pack(side=tk.LEFT, padx=8)

    def ุฅูุดุงุก_ุฅุทุงุฑ_ุงูุฅุญุตุงุฆูุงุช_ุงููุงููุฉ(self):
        """ุฅูุดุงุก ุฅุทุงุฑ ุงูุฅุญุตุงุฆูุงุช ุงููุงููุฉ"""
        self.ุฅุทุงุฑ_ุฅุญุตุงุฆูุงุช = ttk.LabelFrame(self.ุฅุทุงุฑ_ุฑุฆูุณู, 
                                          text="๐ฐ ููุญุฉ ุงูุชุญูู ุงููุงููุฉ", 
                                          padding=15)
        self.ุฅุทุงุฑ_ุฅุญุตุงุฆูุงุช.pack(fill="x", pady=10, padx=10)
        
        # ุฅุทุงุฑ ููุฅุญุตุงุฆูุงุช
        self.ุฅุทุงุฑ_ุฃุฑูุงู = ttk.Frame(self.ุฅุทุงุฑ_ุฅุญุตุงุฆูุงุช)
        self.ุฅุทุงุฑ_ุฃุฑูุงู.pack(fill="x")
        
        # ุณูุชู ุชุญุฏูุซ ูุฐู ุงูุนูุงุตุฑ ูู ุชุญุฏูุซ_ุงูุฅุญุตุงุฆูุงุช_ุงููุงููุฉ
        self.ุชุญุฏูุซ_ุงูุฅุญุตุงุฆูุงุช_ุงููุงููุฉ()

    def ุชุญุฏูุซ_ุงูุฅุญุตุงุฆูุงุช_ุงููุงููุฉ(self):
        """ุชุญุฏูุซ ุงูุฅุญุตุงุฆูุงุช ุงููุงููุฉ"""
        for widget in self.ุฅุทุงุฑ_ุฃุฑูุงู.winfo_children():
            widget.destroy()
            
        if not self.ุงูุจูุงูุงุช:
            ttk.Label(self.ุฅุทุงุฑ_ุฃุฑูุงู, text="ูุง ุชูุฌุฏ ูุฏููุนุงุช ูุณุฌูุฉ", foreground="gray").pack(pady=10)
            return
        
        # ุญุณุงุจ ุงูุฅุญุตุงุฆูุงุช ุงููุงููุฉ
        ุฅุญุตุงุฆูุงุช = self.ุญุณุงุจ_ุงูุฅุญุตุงุฆูุงุช_ุงููุงููุฉ()
        
        # ุนุฑุถ ุงูุฅุญุตุงุฆูุงุช ูู ุดุจูุฉ
        ุงูุฅุญุตุงุฆูุงุช_ุงููููุฉ = [
            ("ุฅุฌูุงูู ุงููุฏููุนุงุช", f"{ุฅุญุตุงุฆูุงุช['ุฅุฌูุงูู_ุงููุฏููุนุงุช']:.2f} $", "๐ฐ"),
            ("ุงููุณุชุญู ูุฐุง ุงูุดูุฑ", f"{ุฅุญุตุงุฆูุงุช['ุงููุณุชุญู_ูุฐุง_ุงูุดูุฑ']:.2f} $", "๐"),
            ("ุงููุชุฃุฎุฑ ูู ุงูุณุฏุงุฏ", f"{ุฅุญุตุงุฆูุงุช['ุงููุชุฃุฎุฑ_ูู_ุงูุณุฏุงุฏ']:.2f} $", "โ๏ธ"),
            ("ุนุฏุฏ ุงูุงุดุชุฑุงูุงุช ุงููุดุทุฉ", f"{ุฅุญุตุงุฆูุงุช['ุนุฏุฏ_ุงููุดุทุฉ']}", "โ"),
            ("ุงููุฏููุนุงุช ุงููุงุฏูุฉ (7 ุฃูุงู)", f"{ุฅุญุตุงุฆูุงุช['ูุฏููุนุงุช_ูุงุฏูุฉ']}", "๐")
        ]
        
        for i, (ุนููุงู, ูููุฉ, ุฃููููุฉ) in enumerate(ุงูุฅุญุตุงุฆูุงุช_ุงููููุฉ):
            ุฅุทุงุฑ_ุฅุญุตุงุฆูุฉ = ttk.Frame(self.ุฅุทุงุฑ_ุฃุฑูุงู, relief='ridge', borderwidth=1)
            ุฅุทุงุฑ_ุฅุญุตุงุฆูุฉ.grid(row=0, column=i, padx=8, pady=5, sticky='nsew')
            
            ttk.Label(ุฅุทุงุฑ_ุฅุญุตุงุฆูุฉ, text=ุฃููููุฉ, font=('Arial', 14)).pack(pady=(5,0))
            ttk.Label(ุฅุทุงุฑ_ุฅุญุตุงุฆูุฉ, text=ุนููุงู, font=('Arial', 9, 'bold'), foreground='gray').pack()
            ttk.Label(ุฅุทุงุฑ_ุฅุญุตุงุฆูุฉ, text=ูููุฉ, font=('Arial', 12, 'bold'), foreground=self.ุฃููุงู['ุฑุฆูุณู']).pack(pady=(0,5))
        
        # ุฌุนู ุงูุฃุนูุฏุฉ ูุชุณุงููุฉ
        for i in range(len(ุงูุฅุญุตุงุฆูุงุช_ุงููููุฉ)):
            self.ุฅุทุงุฑ_ุฃุฑูุงู.columnconfigure(i, weight=1)

    def ุฅูุดุงุก_ุฅุทุงุฑ_ูุงุฆูุฉ_ุงูุงุดุชุฑุงูุงุช(self):
        """ุฅูุดุงุก ุฅุทุงุฑ ูุงุฆูุฉ ุงูุงุดุชุฑุงูุงุช ูุน ุชูุงุตูู ุงูุฏูุน"""
        ุฅุทุงุฑ_ูุงุฆูุฉ = ttk.LabelFrame(self.ุฅุทุงุฑ_ุฑุฆูุณู, 
                                   text="๐ ุณุฌู ุงููุฏููุนุงุช ูุงูุงุดุชุฑุงูุงุช", 
                                   padding=15)
        ุฅุทุงุฑ_ูุงุฆูุฉ.pack(fill="both", expand=True, pady=10, padx=10)
        
        # ุฅูุดุงุก ุงูุฌุฏูู ูุน ุฃุนูุฏุฉ ุชุฑูุฒ ุนูู ุงูุฏูุน
        ุฃุนูุฏุฉ = ('ุงูุงุณู', 'ุงูุณุนุฑ', 'ุชุงุฑูุฎ_ุงูุฏูุน', 'ุงูุฏูุฑุฉ', 'ุงูุญุงูุฉ', 'ุงูุฃูุงู_ุงููุชุจููุฉ', 'ุทุฑููุฉ_ุงูุฏูุน', 'ุงููุจูุบ_ุงููุชุจูู')
        self.ุฌุฏูู = ttk.Treeview(ุฅุทุงุฑ_ูุงุฆูุฉ, columns=ุฃุนูุฏุฉ, show='headings', height=12)
        
        # ุชุนุฑูู ุงูุนูุงููู ูุน ุชุฑููุฒ ุนูู ุงูุฏูุน
        ุนูุงููู = {
            'ุงูุงุณู': {'text': 'ุงุณู ุงูุงุดุชุฑุงู', 'width': 150},
            'ุงูุณุนุฑ': {'text': 'ุงููุจูุบ ุงูุดูุฑู', 'width': 100},
            'ุชุงุฑูุฎ_ุงูุฏูุน': {'text': 'ุชุงุฑูุฎ ุงูุฏูุน ุงููุงุฏู', 'width': 120},
            'ุงูุฏูุฑุฉ': {'text': 'ุฏูุฑุฉ ุงูุฏูุน', 'width': 90},
            'ุงูุญุงูุฉ': {'text': 'ุญุงูุฉ ุงูุฏูุน', 'width': 120},
            'ุงูุฃูุงู_ุงููุชุจููุฉ': {'text': 'ุฃูุงู ูุชุจููุฉ', 'width': 90},
            'ุทุฑููุฉ_ุงูุฏูุน': {'text': 'ุทุฑููุฉ ุงูุฏูุน', 'width': 110},
            'ุงููุจูุบ_ุงููุชุจูู': {'text': 'ุงููุณุชุญู', 'width': 90}
        }
        
        for col, config in ุนูุงููู.items():
            self.ุฌุฏูู.heading(col, text=config['text'])
            self.ุฌุฏูู.column(col, width=config['width'])
        
        # ุดุฑูุท ุงูุชูุฑูุฑ
        ุดุฑูุท_ุชูุฑูุฑ = ttk.Scrollbar(ุฅุทุงุฑ_ูุงุฆูุฉ, orient=tk.VERTICAL, command=self.ุฌุฏูู.yview)
        self.ุฌุฏูู.configure(yscrollcommand=ุดุฑูุท_ุชูุฑูุฑ.set)
        
        self.ุฌุฏูู.pack(side=tk.LEFT, fill="both", expand=True)
        ุดุฑูุท_ุชูุฑูุฑ.pack(side=tk.RIGHT, fill=tk.Y)
        
        # ุฑุจุท ุงูุฃุญุฏุงุซ
        self.ุฌุฏูู.bind('<Double-1>', self.ุนุฑุถ_ุชูุงุตูู_ุงูุฏูุน)
        self.ุฌุฏูู.bind('<Button-3>', self.ุนุฑุถ_ูุงุฆูุฉ_ุงูุณูุงู_ุงูุฏูุน)

    def ุฅูุดุงุก_ุฅุทุงุฑ_ุชูููู_ุงููุฏููุนุงุช(self):
        """ุฅูุดุงุก ุฅุทุงุฑ ุชูููู ูููุฏููุนุงุช ุงููุงุฏูุฉ"""
        ุฅุทุงุฑ_ุชูููู = ttk.LabelFrame(self.ุฅุทุงุฑ_ุฑุฆูุณู, 
                                   text="๐ ุชูููู ุงููุฏููุนุงุช ุงููุงุฏูุฉ", 
                                   padding=10)
        ุฅุทุงุฑ_ุชูููู.pack(fill="x", pady=10, padx=10)
        
        # ุฅุทุงุฑ ููุฃุณุจูุน ุงูุญุงูู
        ุฅุทุงุฑ_ุฃุณุจูุนู = ttk.Frame(ุฅุทุงุฑ_ุชูููู)
        ุฅุทุงุฑ_ุฃุณุจูุนู.pack(fill="x", pady=5)
        
        ttk.Label(ุฅุทุงุฑ_ุฃุณุจูุนู, text="ุงููุฏููุนุงุช ูู ุงูุฃูุงู ุงูุณุจุนุฉ ุงููุงุฏูุฉ:", font=('Arial', 10, 'bold')).pack(anchor='w')
        
        self.ูุงุฆูุฉ_ุงููุฏููุนุงุช_ุงููุงุฏูุฉ = tk.Text(ุฅุทุงุฑ_ุฃุณุจูุนู, height=4, font=('Arial', 9))
        self.ูุงุฆูุฉ_ุงููุฏููุนุงุช_ุงููุงุฏูุฉ.pack(fill="x", pady=5)
        
        # ุชุญุฏูุซ ูุงุฆูุฉ ุงููุฏููุนุงุช ุงููุงุฏูุฉ
        self.ุชุญุฏูุซ_ุงููุฏููุนุงุช_ุงููุงุฏูุฉ()

    def ุชุญุฏูุซ_ุงููุฏููุนุงุช_ุงููุงุฏูุฉ(self):
        """ุชุญุฏูุซ ูุงุฆูุฉ ุงููุฏููุนุงุช ุงููุงุฏูุฉ"""
        self.ูุงุฆูุฉ_ุงููุฏููุนุงุช_ุงููุงุฏูุฉ.delete('1.0', tk.END)
        
        ุงูููู = datetime.now()
        ููุงูุฉ_ุงูุฃุณุจูุน = ุงูููู + timedelta(days=7)
        
        ูุฏููุนุงุช_ูุงุฏูุฉ = []
        for ุงุดุชุฑุงู in self.ุงูุจูุงูุงุช:
            try:
                ุชุงุฑูุฎ_ุฏูุน = datetime.strptime(ุงุดุชุฑุงู['ุชุงุฑูุฎ_ุงูุฏูุน'], '%Y-%m-%d')
                if ุงูููู <= ุชุงุฑูุฎ_ุฏูุน <= ููุงูุฉ_ุงูุฃุณุจูุน:
                    ุฃูุงู_ูุชุจููุฉ = (ุชุงุฑูุฎ_ุฏูุน - ุงูููู).days
                    ูุฏููุนุงุช_ูุงุฏูุฉ.append((ุงุดุชุฑุงู['ุงุณู'], ุงุดุชุฑุงู['ุณุนุฑ'], ุชุงุฑูุฎ_ุฏูุน, ุฃูุงู_ูุชุจููุฉ))
            except:
                continue
        
        if not ูุฏููุนุงุช_ูุงุฏูุฉ:
            self.ูุงุฆูุฉ_ุงููุฏููุนุงุช_ุงููุงุฏูุฉ.insert('1.0', "ูุง ุชูุฌุฏ ูุฏููุนุงุช ูู ุงูุฃุณุจูุน ุงููุงุฏู ๐")
            return
        
        # ุชุฑุชูุจ ุงููุฏููุนุงุช ุญุณุจ ุงูุชุงุฑูุฎ
        ูุฏููุนุงุช_ูุงุฏูุฉ.sort(key=lambda x: x[2])
        
        for ุงุณู, ุณุนุฑ, ุชุงุฑูุฎ, ุฃูุงู in ูุฏููุนุงุช_ูุงุฏูุฉ:
            ูุต = f"๐ {ุงุณู}: {ุณุนุฑ:.2f} $ - ุจุนุฏ {ุฃูุงู} ููู (ูู {ุชุงุฑูุฎ.strftime('%Y-%m-%d')})\n"
            self.ูุงุฆูุฉ_ุงููุฏููุนุงุช_ุงููุงุฏูุฉ.insert(tk.END, ูุต)

    def ุชุณุฌูู_ุฏูุน_ุฌุฏูุฏ(self):
        """ุชุณุฌูู ุฏูุนุฉ ุฌุฏูุฏุฉ ูุน ุงูุชุญูู ูู ุชุงุฑูุฎ ุงูุฏูุน"""
        # ุงูุชุญูู ูู ุงูุจูุงูุงุช ุงูุฃุณุงุณูุฉ
        if not self.ุงูุชุญูู_ูู_ุจูุงูุงุช_ุงูุฏูุน():
            return
        
        # ุฌูุน ุงูุจูุงูุงุช
        ุจูุงูุงุช_ุงูุฏูุน = self.ุฌูุน_ุจูุงูุงุช_ุงูุฏูุน()
        
        # ุญุณุงุจ ุชุงุฑูุฎ ุงูุฏูุน ุงููุงุฏู
        ุชุงุฑูุฎ_ุฏูุน_ูุงุฏู = self.ุญุณุงุจ_ุชุงุฑูุฎ_ุงูุฏูุน_ุงููุงุฏู(ุจูุงูุงุช_ุงูุฏูุน)
        ุจูุงูุงุช_ุงูุฏูุน['ุชุงุฑูุฎ_ุงูุฏูุน'] = ุชุงุฑูุฎ_ุฏูุน_ูุงุฏู.strftime('%Y-%m-%d')
        
        # ุฅุถุงูุฉ ุงูุงุดุชุฑุงู
        self.ุงูุจูุงูุงุช.append(ุจูุงูุงุช_ุงูุฏูุน)
        self.ุญูุธ_ุงูุจูุงูุงุช()
        
        messagebox.showinfo("ุชู ุจูุฌุงุญ", f"ุชู ุชุณุฌูู ุฏูุนุฉ '{ุจูุงูุงุช_ุงูุฏูุน['ุงุณู']}' ุจูุฌุงุญ\nุชุงุฑูุฎ ุงูุฏูุน ุงููุงุฏู: {ุชุงุฑูุฎ_ุฏูุน_ูุงุฏู.strftime('%Y-%m-%d')}")
        
        # ูุณุญ ุงูุญููู ูุชุญุฏูุซ ุงููุงุฌูุฉ
        self.ูุณุญ_ุญููู_ุงูุฏูุน()
        self.ุชุญุฏูุซ_ุงููุงุฆูุฉ()

    def ุงูุชุญูู_ูู_ุจูุงูุงุช_ุงูุฏูุน(self):
        """ุงูุชุญูู ูู ุตุญุฉ ุจูุงูุงุช ุงูุฏูุน"""
        ุงุณู = self.ูุฏุฎู_ุงูุงุณู.get().strip()
        ุณุนุฑ_ูุต = self.ูุฏุฎู_ุงูุณุนุฑ.get().strip()
        ุชุงุฑูุฎ_ุฏูุน = self.ูุฏุฎู_ุชุงุฑูุฎ_ุงูุฏูุน.get().strip()
        
        if not ุงุณู:
            messagebox.showerror("ุฎุทุฃ", "ูุฑุฌู ุฅุฏุฎุงู ุงุณู ุงูุงุดุชุฑุงู")
            self.ูุฏุฎู_ุงูุงุณู.focus()
            return False
            
        if not ุณุนุฑ_ูุต:
            messagebox.showerror("ุฎุทุฃ", "ูุฑุฌู ุฅุฏุฎุงู ุณุนุฑ ุงูุงุดุชุฑุงู")
            self.ูุฏุฎู_ุงูุณุนุฑ.focus()
            return False
            
        try:
            ุณุนุฑ = float(ุณุนุฑ_ูุต)
            if ุณุนุฑ <= 0:
                raise ValueError("ุงูุณุนุฑ ูุฌุจ ุฃู ูููู ููุฌุจุงู")
        except ValueError:
            messagebox.showerror("ุฎุทุฃ", "ูุฑุฌู ุฅุฏุฎุงู ุณุนุฑ ุตุญูุญ ูููุฌุจ")
            self.ูุฏุฎู_ุงูุณุนุฑ.focus()
            return False
        
        if not ุชุงุฑูุฎ_ุฏูุน:
            messagebox.showerror("ุฎุทุฃ", "ูุฑุฌู ุฅุฏุฎุงู ุชุงุฑูุฎ ุงูุฏูุน")
            self.ูุฏุฎู_ุชุงุฑูุฎ_ุงูุฏูุน.focus()
            return False
            
        try:
            datetime.strptime(ุชุงุฑูุฎ_ุฏูุน, '%Y-%m-%d')
        except ValueError:
            messagebox.showerror("ุฎุทุฃ", "ุตูุบุฉ ุงูุชุงุฑูุฎ ุบูุฑ ุตุญูุญุฉ\nุงุณุชุฎุฏู ุงูุตูุบุฉ: YYYY-MM-DD")
            self.ูุฏุฎู_ุชุงุฑูุฎ_ุงูุฏูุน.focus()
            return False
        
        return True

    def ุฌูุน_ุจูุงูุงุช_ุงูุฏูุน(self):
        """ุฌูุน ุจูุงูุงุช ุงูุฏูุน ูู ุงูุญููู"""
        return {
            "ุงุณู": self.ูุฏุฎู_ุงูุงุณู.get().strip(),
            "ุณุนุฑ": float(self.ูุฏุฎู_ุงูุณุนุฑ.get().strip()),
            "ุชุงุฑูุฎ_ุงูุฏูุน": self.ูุฏุฎู_ุชุงุฑูุฎ_ุงูุฏูุน.get().strip(),
            "ุฏูุฑุฉ_ุงูุฏูุน": self.ูุงุฆูุฉ_ุฏูุฑุฉ_ุงูุฏูุน.get(),
            "ุทุฑููุฉ_ุงูุฏูุน": self.ูุงุฆูุฉ_ุทุฑููุฉ_ุงูุฏูุน.get(),
            "ูุฆุฉ": self.ูุงุฆูุฉ_ุงููุฆุฉ.get(),
            "ููุงุญุธุงุช": self.ูุฏุฎู_ุงูููุงุญุธุงุช.get('1.0', tk.END).strip(),
            "ุชุงุฑูุฎ_ุงูุชุณุฌูู": datetime.now().strftime('%Y-%m-%d %H:%M:%S'),
            "ุญุงูุฉ_ุงูุฏูุน": "ูุดุท"
        }

    def ุญุณุงุจ_ุชุงุฑูุฎ_ุงูุฏูุน_ุงููุงุฏู(self, ุจูุงูุงุช_ุงูุฏูุน):
        """ุญุณุงุจ ุชุงุฑูุฎ ุงูุฏูุน ุงููุงุฏู ุจูุงุกู ุนูู ุฏูุฑุฉ ุงูุฏูุน"""
        ุชุงุฑูุฎ_ุขุฎุฑ_ุฏูุน = datetime.strptime(ุจูุงูุงุช_ุงูุฏูุน['ุชุงุฑูุฎ_ุงูุฏูุน'], '%Y-%m-%d')
        ุฏูุฑุฉ = ุจูุงูุงุช_ุงูุฏูุน['ุฏูุฑุฉ_ุงูุฏูุน']
        
        if ุฏูุฑุฉ == "ุดูุฑู":
            return ุชุงุฑูุฎ_ุขุฎุฑ_ุฏูุน + timedelta(days=30)
        elif ุฏูุฑุฉ == "ุฑุจุน ุณููู":
            return ุชุงุฑูุฎ_ุขุฎุฑ_ุฏูุน + timedelta(days=90)
        elif ุฏูุฑุฉ == "ูุตู ุณููู":
            return ุชุงุฑูุฎ_ุขุฎุฑ_ุฏูุน + timedelta(days=180)
        elif ุฏูุฑุฉ == "ุณููู":
            return ุชุงุฑูุฎ_ุขุฎุฑ_ุฏูุน + timedelta(days=365)
        else:
            return ุชุงุฑูุฎ_ุขุฎุฑ_ุฏูุน + timedelta(days=30)  # ุงูุชุฑุงุถู

    def ูุณุญ_ุญููู_ุงูุฏูุน(self):
        """ูุณุญ ุญููู ุฅุฏุฎุงู ุงูุฏูุน"""
        self.ูุฏุฎู_ุงูุงุณู.delete(0, tk.END)
        self.ูุฏุฎู_ุงูุณุนุฑ.delete(0, tk.END)
        self.ูุฏุฎู_ุงูููุงุญุธุงุช.delete('1.0', tk.END)
        self.ูุฏุฎู_ุงูุงุณู.focus()

    def ุชุฃููุฏ_ุงูุฏูุน(self):
        """ุชุฃููุฏ ุฅุฌุฑุงุก ุฏูุนุฉ ููุงุดุชุฑุงู ุงููุญุฏุฏ"""
        ูุฎุชุงุฑ = self.ุฌุฏูู.selection()
        if not ูุฎุชุงุฑ:
            messagebox.showwarning("ุชูุจูู", "ูุฑุฌู ุงุฎุชูุงุฑ ุงุดุชุฑุงู ูุชุฃููุฏ ุงูุฏูุน")
            return
            
        ููุฑุณ = self.ุฌุฏูู.index(ูุฎุชุงุฑ[0])
        if 0 <= ููุฑุณ < len(self.ุงูุจูุงูุงุช):
            self.ุชุณุฌูู_ุฏูุนุฉ_ุฌุฏูุฏุฉ(ููุฑุณ)

    def ุชุณุฌูู_ุฏูุนุฉ_ุฌุฏูุฏุฉ(self, ููุฑุณ):
        """ุชุณุฌูู ุฏูุนุฉ ุฌุฏูุฏุฉ ููุงุดุชุฑุงู ุงููุญุฏุฏ"""
        ุงุดุชุฑุงู = self.ุงูุจูุงูุงุช[ููุฑุณ]
        
        # ุฅูุดุงุก ูุงูุฐุฉ ุชุฃููุฏ ุงูุฏูุน
        ูุงูุฐุฉ_ุฏูุน = tk.Toplevel(self.ูุงูุฐุฉ)
        ูุงูุฐุฉ_ุฏูุน.title("ุชุฃููุฏ ุนูููุฉ ุงูุฏูุน")
        ูุงูุฐุฉ_ุฏูุน.geometry("400x300")
        ูุงูุฐุฉ_ุฏูุน.transient(self.ูุงูุฐุฉ)
        ูุงูุฐุฉ_ุฏูุน.grab_set()
        
        ttk.Label(ูุงูุฐุฉ_ุฏูุน, text="๐ณ ุชุฃููุฏ ุนูููุฉ ุงูุฏูุน", font=('Arial', 16, 'bold')).pack(pady=15)
        
        ุฅุทุงุฑ_ุฏูุน = ttk.Frame(ูุงูุฐุฉ_ุฏูุน, padding=20)
        ุฅุทุงุฑ_ุฏูุน.pack(fill="both", expand=True)
        
        # ุนุฑุถ ูุนูููุงุช ุงูุงุดุชุฑุงู
        ttk.Label(ุฅุทุงุฑ_ุฏูุน, text=f"ุงูุงุดุชุฑุงู: {ุงุดุชุฑุงู['ุงุณู']}", font=('Arial', 12, 'bold')).pack(anchor='w', pady=5)
        ttk.Label(ุฅุทุงุฑ_ุฏูุน, text=f"ุงููุจูุบ: {ุงุดุชุฑุงู['ุณุนุฑ']:.2f} $", font=('Arial', 11)).pack(anchor='w', pady=2)
        ttk.Label(ุฅุทุงุฑ_ุฏูุน, text=f"ุขุฎุฑ ุฏูุน: {ุงุดุชุฑุงู['ุชุงุฑูุฎ_ุงูุฏูุน']}", font=('Arial', 11)).pack(anchor='w', pady=2)
        
        # ุญูู ุชุงุฑูุฎ ุงูุฏูุน ุงูุฌุฏูุฏ
        ุฅุทุงุฑ_ุชุงุฑูุฎ = ttk.Frame(ุฅุทุงุฑ_ุฏูุน)
        ุฅุทุงุฑ_ุชุงุฑูุฎ.pack(fill="x", pady=15)
        
        ttk.Label(ุฅุทุงุฑ_ุชุงุฑูุฎ, text="ุชุงุฑูุฎ ุงูุฏูุน ุงูุฌุฏูุฏ:", font=('Arial', 10, 'bold')).pack(side=tk.LEFT)
        ูุฏุฎู_ุชุงุฑูุฎ_ุฌุฏูุฏ = ttk.Entry(ุฅุทุงุฑ_ุชุงุฑูุฎ, width=12, font=('Arial', 10))
        ูุฏุฎู_ุชุงุฑูุฎ_ุฌุฏูุฏ.insert(0, datetime.now().strftime('%Y-%m-%d'))
        ูุฏุฎู_ุชุงุฑูุฎ_ุฌุฏูุฏ.pack(side=tk.LEFT, padx=5)
        
        # ุญูู ุงูููุงุญุธุงุช ุงูุฅุถุงููุฉ
        ttk.Label(ุฅุทุงุฑ_ุฏูุน, text="ููุงุญุธุงุช ุงูุฏูุน:", font=('Arial', 10, 'bold')).pack(anchor='w', pady=(10,5))
        ูุฏุฎู_ููุงุญุธุงุช_ุฏูุน = tk.Text(ุฅุทุงุฑ_ุฏูุน, width=40, height=4)
        ูุฏุฎู_ููุงุญุธุงุช_ุฏูุน.pack(fill="x", pady=5)
        
        def ุชุฃููุฏ_ุงูุฏูุนุฉ():
            ุชุงุฑูุฎ_ุฌุฏูุฏ = ูุฏุฎู_ุชุงุฑูุฎ_ุฌุฏูุฏ.get().strip()
            ููุงุญุธุงุช = ูุฏุฎู_ููุงุญุธุงุช_ุฏูุน.get('1.0', tk.END).strip()
            
            # ุงูุชุญูู ูู ุตุญุฉ ุงูุชุงุฑูุฎ
            try:
                datetime.strptime(ุชุงุฑูุฎ_ุฌุฏูุฏ, '%Y-%m-%d')
            except ValueError:
                messagebox.showerror("ุฎุทุฃ", "ุตูุบุฉ ุงูุชุงุฑูุฎ ุบูุฑ ุตุญูุญุฉ")
                return
            
            # ุชุญุฏูุซ ุชุงุฑูุฎ ุงูุฏูุน
            ุงุดุชุฑุงู['ุชุงุฑูุฎ_ุงูุฏูุน'] = ุชุงุฑูุฎ_ุฌุฏูุฏ
            if ููุงุญุธุงุช:
                ุงุดุชุฑุงู['ููุงุญุธุงุช_ุฏูุน'] = ุงุดุชุฑุงู.get('ููุงุญุธุงุช_ุฏูุน', '') + f"\nุฏูุนุฉ ูู {datetime.now().strftime('%Y-%m-%d')}: {ููุงุญุธุงุช}"
            
            # ุชุญุฏูุซ ุงูุจูุงูุงุช
            self.ุญูุธ_ุงูุจูุงูุงุช()
            self.ุชุญุฏูุซ_ุงููุงุฆูุฉ()
            ูุงูุฐุฉ_ุฏูุน.destroy()
            messagebox.showinfo("ุชู ุงูุฏูุน", f"ุชู ุชุณุฌูู ุงูุฏูุนุฉ ูู '{ุงุดุชุฑุงู['ุงุณู']}' ุจูุฌุงุญ")
        
        # ุฃุฒุฑุงุฑ ุงูุชุฃููุฏ
        ุฅุทุงุฑ_ุฃุฒุฑุงุฑ = ttk.Frame(ุฅุทุงุฑ_ุฏูุน)
        ุฅุทุงุฑ_ุฃุฒุฑุงุฑ.pack(pady=20)
        
        ttk.Button(ุฅุทุงุฑ_ุฃุฒุฑุงุฑ, text="๐ณ ุชุฃููุฏ ุงูุฏูุน", command=ุชุฃููุฏ_ุงูุฏูุนุฉ).pack(side=tk.LEFT, padx=10)
        ttk.Button(ุฅุทุงุฑ_ุฃุฒุฑุงุฑ, text="โ ุฅูุบุงุก", command=ูุงูุฐุฉ_ุฏูุน.destroy).pack(side=tk.LEFT, padx=10)

    def ุชุนุฏูู_ุฏูุน(self):
        """ุชุนุฏูู ุจูุงูุงุช ุงูุฏูุน ููุงุดุชุฑุงู ุงููุญุฏุฏ"""
        ูุฎุชุงุฑ = self.ุฌุฏูู.selection()
        if not ูุฎุชุงุฑ:
            messagebox.showwarning("ุชูุจูู", "ูุฑุฌู ุงุฎุชูุงุฑ ุงุดุชุฑุงู ููุชุนุฏูู")
            return
            
        ููุฑุณ = self.ุฌุฏูู.index(ูุฎุชุงุฑ[0])
        if 0 <= ููุฑุณ < len(self.ุงูุจูุงูุงุช):
            self.ุชุนุฏูู_ุจูุงูุงุช_ุงูุฏูุน(ููุฑุณ)

    def ุชุนุฏูู_ุจูุงูุงุช_ุงูุฏูุน(self, ููุฑุณ):
        """ุชุนุฏูู ุจูุงูุงุช ุงูุฏูุน ููุงุดุชุฑุงู"""
        ุงุดุชุฑุงู = self.ุงูุจูุงูุงุช[ููุฑุณ]
        
        ูุงูุฐุฉ_ุชุนุฏูู = tk.Toplevel(self.ูุงูุฐุฉ)
        ูุงูุฐุฉ_ุชุนุฏูู.title("ุชุนุฏูู ุจูุงูุงุช ุงูุฏูุน")
        ูุงูุฐุฉ_ุชุนุฏูู.geometry("500x400")
        ูุงูุฐุฉ_ุชุนุฏูู.transient(self.ูุงูุฐุฉ)
        ูุงูุฐุฉ_ุชุนุฏูู.grab_set()
        
        ttk.Label(ูุงูุฐุฉ_ุชุนุฏูู, text="โ๏ธ ุชุนุฏูู ุจูุงูุงุช ุงูุฏูุน", font=('Arial', 16, 'bold')).pack(pady=15)
        
        ุฅุทุงุฑ_ุชุนุฏูู = ttk.Frame(ูุงูุฐุฉ_ุชุนุฏูู, padding=20)
        ุฅุทุงุฑ_ุชุนุฏูู.pack(fill="both", expand=True)
        
        # ุญููู ุงูุชุนุฏูู
        ุงูุญููู = [
            ("ุงุณู ุงูุงุดุชุฑุงู:", "ูุฏุฎู_ุงุณู", ุงุดุชุฑุงู['ุงุณู'], 30),
            ("ุงูุณุนุฑ ุงูุดูุฑู:", "ูุฏุฎู_ุณุนุฑ", str(ุงุดุชุฑุงู['ุณุนุฑ']), 15),
            ("ุชุงุฑูุฎ ุงูุฏูุน:", "ูุฏุฎู_ุชุงุฑูุฎ", ุงุดุชุฑุงู['ุชุงุฑูุฎ_ุงูุฏูุน'], 15),
            ("ุฏูุฑุฉ ุงูุฏูุน:", "ูุงุฆูุฉ_ุฏูุฑุฉ", ุงุดุชุฑุงู['ุฏูุฑุฉ_ุงูุฏูุน'], 12),
            ("ุทุฑููุฉ ุงูุฏูุน:", "ูุงุฆูุฉ_ุทุฑููุฉ", ุงุดุชุฑุงู['ุทุฑููุฉ_ุงูุฏูุน'], 15),
            ("ุงููุฆุฉ:", "ูุงุฆูุฉ_ูุฆุฉ", ุงุดุชุฑุงู['ูุฆุฉ'], 12)
        ]
        
        ุงููุชุบูุฑุงุช = {}
        for i, (ุชุณููุฉ, ููุชุงุญ, ูููุฉ, ุนุฑุถ) in enumerate(ุงูุญููู):
            ttk.Label(ุฅุทุงุฑ_ุชุนุฏูู, text=ุชุณููุฉ).grid(row=i, column=0, sticky='w', pady=8, padx=5)
            
            if 'ูุงุฆูุฉ' in ููุชุงุญ:
                if 'ุฏูุฑุฉ' in ููุชุงุญ:
                    ููู = ["ุดูุฑู", "ุฑุจุน ุณููู", "ูุตู ุณููู", "ุณููู"]
                elif 'ุทุฑููุฉ' in ููุชุงุญ:
                    ููู = ["ุจุทุงูุฉ ุงุฆุชูุงู", "ุชุญููู ุจููู", "PayPal", "ููุฏู", "ุฃุฎุฑู"]
                else:
                    ููู = ["ุชุฑููู", "ุชุนููู", "ุฃุนูุงู", "ุชุณูู", "ุจุฑุงูุฌ", "ุฃุฎุฑู"]
                
                ูุชุบูุฑ = ttk.Combobox(ุฅุทุงุฑ_ุชุนุฏูู, width=ุนุฑุถ, values=ููู, state="readonly")
                ูุชุบูุฑ.set(ูููุฉ)
            else:
                ูุชุบูุฑ = ttk.Entry(ุฅุทุงุฑ_ุชุนุฏูู, width=ุนุฑุถ)
                ูุชุบูุฑ.insert(0, ูููุฉ)
            
            ูุชุบูุฑ.grid(row=i, column=1, sticky='w', pady=8, padx=5)
            ุงููุชุบูุฑุงุช[ููุชุงุญ] = ูุชุบูุฑ
        
        # ุญูู ุงูููุงุญุธุงุช
        ttk.Label(ุฅุทุงุฑ_ุชุนุฏูู, text="ููุงุญุธุงุช:").grid(row=len(ุงูุญููู), column=0, sticky='nw', pady=8, padx=5)
        ูุฏุฎู_ููุงุญุธุงุช = tk.Text(ุฅุทุงุฑ_ุชุนุฏูู, width=40, height=6)
        ูุฏุฎู_ููุงุญุธุงุช.insert('1.0', ุงุดุชุฑุงู.get('ููุงุญุธุงุช', ''))
        ูุฏุฎู_ููุงุญุธุงุช.grid(row=len(ุงูุญููู), column=1, sticky='ew', pady=8, padx=5)
        
        def ุญูุธ_ุงูุชุนุฏููุงุช():
            # ุชุญุฏูุซ ุงูุจูุงูุงุช
            ุงุดุชุฑุงู['ุงุณู'] = ุงููุชุบูุฑุงุช['ูุฏุฎู_ุงุณู'].get().strip()
            try:
                ุงุดุชุฑุงู['ุณุนุฑ'] = float(ุงููุชุบูุฑุงุช['ูุฏุฎู_ุณุนุฑ'].get().strip())
            except ValueError:
                messagebox.showerror("ุฎุทุฃ", "ุงูุณุนุฑ ูุฌุจ ุฃู ูููู ุฑููุงู")
                return
            
            # ุงูุชุญูู ูู ุตุญุฉ ุงูุชุงุฑูุฎ
            try:
                datetime.strptime(ุงููุชุบูุฑุงุช['ูุฏุฎู_ุชุงุฑูุฎ'].get().strip(), '%Y-%m-%d')
            except ValueError:
                messagebox.showerror("ุฎุทุฃ", "ุตูุบุฉ ุงูุชุงุฑูุฎ ุบูุฑ ุตุญูุญุฉ")
                return
                
            ุงุดุชุฑุงู['ุชุงุฑูุฎ_ุงูุฏูุน'] = ุงููุชุบูุฑุงุช['ูุฏุฎู_ุชุงุฑูุฎ'].get().strip()
            ุงุดุชุฑุงู['ุฏูุฑุฉ_ุงูุฏูุน'] = ุงููุชุบูุฑุงุช['ูุงุฆูุฉ_ุฏูุฑุฉ'].get()
            ุงุดุชุฑุงู['ุทุฑููุฉ_ุงูุฏูุน'] = ุงููุชุบูุฑุงุช['ูุงุฆูุฉ_ุทุฑููุฉ'].get()
            ุงุดุชุฑุงู['ูุฆุฉ'] = ุงููุชุบูุฑุงุช['ูุงุฆูุฉ_ูุฆุฉ'].get()
            ุงุดุชุฑุงู['ููุงุญุธุงุช'] = ูุฏุฎู_ููุงุญุธุงุช.get('1.0', tk.END).strip()
            
            self.ุญูุธ_ุงูุจูุงูุงุช()
            self.ุชุญุฏูุซ_ุงููุงุฆูุฉ()
            ูุงูุฐุฉ_ุชุนุฏูู.destroy()
            messagebox.showinfo("ุชู", "ุชู ุชุนุฏูู ุจูุงูุงุช ุงูุฏูุน ุจูุฌุงุญ")
        
        # ุฃุฒุฑุงุฑ ุงูุญูุธ ูุงูุฅูุบุงุก
        ุฅุทุงุฑ_ุฃุฒุฑุงุฑ = ttk.Frame(ุฅุทุงุฑ_ุชุนุฏูู)
        ุฅุทุงุฑ_ุฃุฒุฑุงุฑ.grid(row=len(ุงูุญููู)+1, column=0, columnspan=2, pady=20)
        
        ttk.Button(ุฅุทุงุฑ_ุฃุฒุฑุงุฑ, text="๐พ ุญูุธ ุงูุชุนุฏููุงุช", command=ุญูุธ_ุงูุชุนุฏููุงุช).pack(side=tk.LEFT, padx=10)
        ttk.Button(ุฅุทุงุฑ_ุฃุฒุฑุงุฑ, text="โ ุฅูุบุงุก", command=ูุงูุฐุฉ_ุชุนุฏูู.destroy).pack(side=tk.LEFT, padx=10)

    def ุญุณุงุจ_ุงูุฅุญุตุงุฆูุงุช_ุงููุงููุฉ(self):
        """ุญุณุงุจ ุงูุฅุญุตุงุฆูุงุช ุงููุงููุฉ ุงููุชูุฏูุฉ"""
        if not self.ุงูุจูุงูุงุช:
            return {
                'ุฅุฌูุงูู_ุงููุฏููุนุงุช': 0,
                'ุงููุณุชุญู_ูุฐุง_ุงูุดูุฑ': 0,
                'ุงููุชุฃุฎุฑ_ูู_ุงูุณุฏุงุฏ': 0,
                'ุนุฏุฏ_ุงููุดุทุฉ': 0,
                'ูุฏููุนุงุช_ูุงุฏูุฉ': 0
            }
        
        ุงูููู = datetime.now()
        ุฅุฌูุงูู_ุงููุฏููุนุงุช = 0
        ุงููุณุชุญู_ูุฐุง_ุงูุดูุฑ = 0
        ุงููุชุฃุฎุฑ_ูู_ุงูุณุฏุงุฏ = 0
        ุนุฏุฏ_ุงููุดุทุฉ = 0
        ูุฏููุนุงุช_ูุงุฏูุฉ = 0
        
        for ุงุดุชุฑุงู in self.ุงูุจูุงูุงุช:
            try:
                ุชุงุฑูุฎ_ุฏูุน = datetime.strptime(ุงุดุชุฑุงู['ุชุงุฑูุฎ_ุงูุฏูุน'], '%Y-%m-%d')
                ุณุนุฑ = ุงุดุชุฑุงู['ุณุนุฑ']
                
                # ุฅุฌูุงูู ุงููุฏููุนุงุช (ุฌููุน ุงูุงุดุชุฑุงูุงุช ุงููุดุทุฉ)
                ุฅุฌูุงูู_ุงููุฏููุนุงุช += ุณุนุฑ
                
                # ุงููุณุชุญู ูุฐุง ุงูุดูุฑ
                if ุชุงุฑูุฎ_ุฏูุน.month == ุงูููู.month and ุชุงุฑูุฎ_ุฏูุน.year == ุงูููู.year:
                    ุงููุณุชุญู_ูุฐุง_ุงูุดูุฑ += ุณุนุฑ
                
                # ุงููุชุฃุฎุฑ ูู ุงูุณุฏุงุฏ
                if ุชุงุฑูุฎ_ุฏูุน < ุงูููู:
                    ุงููุชุฃุฎุฑ_ูู_ุงูุณุฏุงุฏ += ุณุนุฑ
                
                # ุงูุงุดุชุฑุงูุงุช ุงููุดุทุฉ
                if ุชุงุฑูุฎ_ุฏูุน >= ุงูููู:
                    ุนุฏุฏ_ุงููุดุทุฉ += 1
                
                # ุงููุฏููุนุงุช ุงููุงุฏูุฉ ูู 7 ุฃูุงู
                if ุงูููู <= ุชุงุฑูุฎ_ุฏูุน <= (ุงูููู + timedelta(days=7)):
                    ูุฏููุนุงุช_ูุงุฏูุฉ += 1
                    
            except Exception as e:
                print(f"ุฎุทุฃ ูู ุญุณุงุจ ุฅุญุตุงุฆูุงุช ุงูุงุดุชุฑุงู: {e}")
                continue
        
        return {
            'ุฅุฌูุงูู_ุงููุฏููุนุงุช': ุฅุฌูุงูู_ุงููุฏููุนุงุช,
            'ุงููุณุชุญู_ูุฐุง_ุงูุดูุฑ': ุงููุณุชุญู_ูุฐุง_ุงูุดูุฑ,
            'ุงููุชุฃุฎุฑ_ูู_ุงูุณุฏุงุฏ': ุงููุชุฃุฎุฑ_ูู_ุงูุณุฏุงุฏ,
            'ุนุฏุฏ_ุงููุดุทุฉ': ุนุฏุฏ_ุงููุดุทุฉ,
            'ูุฏููุนุงุช_ูุงุฏูุฉ': ูุฏููุนุงุช_ูุงุฏูุฉ
        }

    def ุชุญุฏูุซ_ุงููุงุฆูุฉ(self):
        """ุชุญุฏูุซ ูุงุฆูุฉ ุงูุงุดุชุฑุงูุงุช ูุน ูุนูููุงุช ุงูุฏูุน"""
        # ูุณุญ ุงูุจูุงูุงุช ุงููุฏููุฉ
        for ุนูุตุฑ in self.ุฌุฏูู.get_children():
            self.ุฌุฏูู.delete(ุนูุตุฑ)
        
        # ุฅุถุงูุฉ ุงูุจูุงูุงุช ุงูุฌุฏูุฏุฉ
        for ุงุดุชุฑุงู in self.ุงูุจูุงูุงุช:
            self.ุฅุถุงูุฉ_ุตู_ุฏูุน_ุฅูู_ุงูุฌุฏูู(ุงุดุชุฑุงู)
        
        # ุชุญุฏูุซ ุงูุฅุญุตุงุฆูุงุช ูุงููุฏููุนุงุช ุงููุงุฏูุฉ
        self.ุชุญุฏูุซ_ุงูุฅุญุตุงุฆูุงุช_ุงููุงููุฉ()
        self.ุชุญุฏูุซ_ุงููุฏููุนุงุช_ุงููุงุฏูุฉ()

    def ุฅุถุงูุฉ_ุตู_ุฏูุน_ุฅูู_ุงูุฌุฏูู(self, ุงุดุชุฑุงู):
        """ุฅุถุงูุฉ ุตู ุฏูุนุฉ ุฅูู ุงูุฌุฏูู"""
        try:
            ุชุงุฑูุฎ_ุฏูุน = datetime.strptime(ุงุดุชุฑุงู['ุชุงุฑูุฎ_ุงูุฏูุน'], '%Y-%m-%d')
            ุงูููู = datetime.now()
            ุฃูุงู_ูุชุจููุฉ = (ุชุงุฑูุฎ_ุฏูุน - ุงูููู).days
            
            if ุฃูุงู_ูุชุจููุฉ < 0:
                ุญุงูุฉ = "๐ ูุชุฃุฎุฑ"
                ููู = "ูุชุฃุฎุฑ"
                ูุจูุบ_ูุณุชุญู = ุงุดุชุฑุงู['ุณุนุฑ']
            elif ุฃูุงู_ูุชุจููุฉ == 0:
                ุญุงูุฉ = "โ๏ธ ูุณุชุญู ุงูููู"
                ููู = "ุนุงุฌู"
                ูุจูุบ_ูุณุชุญู = ุงุดุชุฑุงู['ุณุนุฑ']
            elif ุฃูุงู_ูุชุจููุฉ <= 7:
                ุญุงูุฉ = "๐ถ ูุฑูุจ"
                ููู = "ูุฑูุจ"
                ูุจูุบ_ูุณุชุญู = ุงุดุชุฑุงู['ุณุนุฑ']
            else:
                ุญุงูุฉ = "โ ูุดุท"
                ููู = "ูุดุท"
                ูุจูุบ_ูุณุชุญู = 0.0
                
        except Exception as e:
            ุญุงูุฉ = "โ ุบูุฑ ูุนุฑูู"
            ุฃูุงู_ูุชุจููุฉ = "ุ"
            ููู = "ูุดุท"
            ูุจูุบ_ูุณุชุญู = 0.0
        
        # ุฅุถุงูุฉ ุงูุตู ุฅูู ุงูุฌุฏูู
        self.ุฌุฏูู.insert('', 'end', 
                        values=(
                            ุงุดุชุฑุงู['ุงุณู'],
                            f"{ุงุดุชุฑุงู['ุณุนุฑ']:.2f}",
                            ุงุดุชุฑุงู['ุชุงุฑูุฎ_ุงูุฏูุน'],
                            ุงุดุชุฑุงู['ุฏูุฑุฉ_ุงูุฏูุน'],
                            ุญุงูุฉ,
                            ุฃูุงู_ูุชุจููุฉ if isinstance(ุฃูุงู_ูุชุจููุฉ, int) else ุฃูุงู_ูุชุจููุฉ,
                            ุงุดุชุฑุงู['ุทุฑููุฉ_ุงูุฏูุน'],
                            f"{ูุจูุบ_ูุณุชุญู:.2f}" if ูุจูุบ_ูุณุชุญู > 0 else "0.00"
                        ), 
                        tags=(ููู,))
        
        # ุชูููู ุงูุฃููุงู
        self.ุฌุฏูู.tag_configure('ูุชุฃุฎุฑ', background=self.ุฃููุงู['ูุชุฃุฎุฑ'], foreground='#c62828')
        self.ุฌุฏูู.tag_configure('ุนุงุฌู', background=self.ุฃููุงู['ุนุงุฌู'], foreground='#ef6c00')
        self.ุฌุฏูู.tag_configure('ูุฑูุจ', background=self.ุฃููุงู['ูุฑูุจ'], foreground='#f9a825')
        self.ุฌุฏูู.tag_configure('ูุดุท', background=self.ุฃููุงู['ูุดุท'], foreground='#2e7d32')

    def ุนุฑุถ_ุชูุงุตูู_ุงูุฏูุน(self, event=None):
        """ุนุฑุถ ุชูุงุตูู ุงูุฏูุน ููุงุดุชุฑุงู ุงููุญุฏุฏ"""
        ูุฎุชุงุฑ = self.ุฌุฏูู.selection()
        if not ูุฎุชุงุฑ:
            return
            
        ููุฑุณ = self.ุฌุฏูู.index(ูุฎุชุงุฑ[0])
        if 0 <= ููุฑุณ < len(self.ุงูุจูุงูุงุช):
            ุงุดุชุฑุงู = self.ุงูุจูุงูุงุช[ููุฑุณ]
            
            # ุญุณุงุจ ุงูุฃูุงู ุงููุชุจููุฉ
            try:
                ุชุงุฑูุฎ_ุฏูุน = datetime.strptime(ุงุดุชุฑุงู['ุชุงุฑูุฎ_ุงูุฏูุน'], '%Y-%m-%d')
                ุฃูุงู_ูุชุจููุฉ = (ุชุงุฑูุฎ_ุฏูุน - datetime.now()).days
                if ุฃูุงู_ูุชุจููุฉ < 0:
                    ุญุงูุฉ = "ูุชุฃุฎุฑ ูู ุงูุณุฏุงุฏ"
                elif ุฃูุงู_ูุชุจููุฉ == 0:
                    ุญุงูุฉ = "ูุณุชุญู ุงูููู"
                elif ุฃูุงู_ูุชุจููุฉ <= 7:
                    ุญุงูุฉ = "ูุฑูุจ ูู ุงูุงุณุชุญูุงู"
                else:
                    ุญุงูุฉ = "ูุดุท"
            except:
                ุฃูุงู_ูุชุจููุฉ = "ุบูุฑ ูุนุฑูู"
                ุญุงูุฉ = "ุบูุฑ ูุนุฑูู"
            
            ุชูุงุตูู = f"""
๐ณ ุชูุงุตูู ุงูุฏูุน ูุงูุงุดุชุฑุงู:

๐ ุงุณู ุงูุงุดุชุฑุงู: {ุงุดุชุฑุงู['ุงุณู']}
๐ฐ ุงูุณุนุฑ ุงูุดูุฑู: {ุงุดุชุฑุงู['ุณุนุฑ']:.2f} $
๐ ุชุงุฑูุฎ ุงูุฏูุน ุงููุงุฏู: {ุงุดุชุฑุงู['ุชุงุฑูุฎ_ุงูุฏูุน']}
๐ ุฏูุฑุฉ ุงูุฏูุน: {ุงุดุชุฑุงู['ุฏูุฑุฉ_ุงูุฏูุน']}
๐ณ ุทุฑููุฉ ุงูุฏูุน: {ุงุดุชุฑุงู['ุทุฑููุฉ_ุงูุฏูุน']}
๐ ุงููุฆุฉ: {ุงุดุชุฑุงู['ูุฆุฉ']}
๐ฏ ุญุงูุฉ ุงูุฏูุน: {ุญุงูุฉ}
โฐ ุงูุฃูุงู ุงููุชุจููุฉ: {ุฃูุงู_ูุชุจููุฉ if isinstance(ุฃูุงู_ูุชุจููุฉ, int) else ุฃูุงู_ูุชุจููุฉ} ููู
๐ ุชุงุฑูุฎ ุงูุชุณุฌูู: {ุงุดุชุฑุงู.get('ุชุงุฑูุฎ_ุงูุชุณุฌูู', 'ุบูุฑ ูุนุฑูู')}
๐ ููุงุญุธุงุช: {ุงุดุชุฑุงู.get('ููุงุญุธุงุช', 'ูุง ุชูุฌุฏ ููุงุญุธุงุช')}
            """
            
            messagebox.showinfo(f"ุชูุงุตูู ุงูุฏูุน - {ุงุดุชุฑุงู['ุงุณู']}", ุชูุงุตูู.strip())

    def ุนุฑุถ_ูุงุฆูุฉ_ุงูุณูุงู_ุงูุฏูุน(self, event):
        """ุนุฑุถ ูุงุฆูุฉ ุงูุณูุงู ุงูุฎุงุตุฉ ุจุงูุฏูุน"""
        ูุฎุชุงุฑ = self.ุฌุฏูู.identify_row(event.y)
        if not ูุฎุชุงุฑ:
            return
            
        self.ุฌุฏูู.selection_set(ูุฎุชุงุฑ)
        
        ูุงุฆูุฉ_ุงูุณูุงู = tk.Menu(self.ูุงูุฐุฉ, tearoff=0)
        ูุงุฆูุฉ_ุงูุณูุงู.add_command(label="ุนุฑุถ ุชูุงุตูู ุงูุฏูุน", command=self.ุนุฑุถ_ุชูุงุตูู_ุงูุฏูุน)
        ูุงุฆูุฉ_ุงูุณูุงู.add_command(label="ุชุฃููุฏ ุงูุฏูุน", command=self.ุชุฃููุฏ_ุงูุฏูุน)
        ูุงุฆูุฉ_ุงูุณูุงู.add_command(label="ุชุนุฏูู ุจูุงูุงุช ุงูุฏูุน", command=self.ุชุนุฏูู_ุฏูุน)
        ูุงุฆูุฉ_ุงูุณูุงู.add_separator()
        ูุงุฆูุฉ_ุงูุณูุงู.add_command(label="ุญุฐู ุงูุงุดุชุฑุงู", command=self.ุญุฐู_ุงุดุชุฑุงู)
        
        ูุงุฆูุฉ_ุงูุณูุงู.tk_popup(event.x_root, event.y_root)

    def ุญุฐู_ุงุดุชุฑุงู(self):
        """ุญุฐู ุงุดุชุฑุงู ูู ุงูุณุฌู"""
        ูุฎุชุงุฑ = self.ุฌุฏูู.selection()
        if not ูุฎุชุงุฑ:
            messagebox.showwarning("ุชูุจูู", "ูุฑุฌู ุงุฎุชูุงุฑ ุงุดุชุฑุงู ููุญุฐู")
            return
            
        ููุฑุณ = self.ุฌุฏูู.index(ูุฎุชุงุฑ[0])
        if 0 <= ููุฑุณ < len(self.ุงูุจูุงูุงุช):
            ุงุณู = self.ุงูุจูุงูุงุช[ููุฑุณ]['ุงุณู']
            if messagebox.askyesno("ุชุฃููุฏ ุงูุญุฐู", f"ูู ุฃูุช ูุชุฃูุฏ ูู ุญุฐู ุงุดุชุฑุงู '{ุงุณู}'ุ"):
                del self.ุงูุจูุงูุงุช[ููุฑุณ]
                self.ุญูุธ_ุงูุจูุงูุงุช()
                self.ุชุญุฏูุซ_ุงููุงุฆูุฉ()
                messagebox.showinfo("ุชู", f"ุชู ุญุฐู ุงุดุชุฑุงู '{ุงุณู}' ุจูุฌุงุญ")

    def ุนุฑุถ_ุชูุฑูุฑ_ุงูุฏูุน(self):
        """ุนุฑุถ ุชูุฑูุฑ ููุตู ุนู ุงููุฏููุนุงุช"""
        if not self.ุงูุจูุงูุงุช:
            messagebox.showinfo("ุงูุชูุงุฑูุฑ", "ูุง ุชูุฌุฏ ูุฏููุนุงุช ูุณุฌูุฉ")
            return
            
        # ุญุณุงุจ ุงูุชูุงุฑูุฑ
        ุชูุงุฑูุฑ = self.ุญุณุงุจ_ุชูุงุฑูุฑ_ุงูุฏูุน()
        
        # ุฅูุดุงุก ูุงูุฐุฉ ุงูุชูุงุฑูุฑ
        ูุงูุฐุฉ_ุชูุฑูุฑ = tk.Toplevel(self.ูุงูุฐุฉ)
        ูุงูุฐุฉ_ุชูุฑูุฑ.title("๐ ุชูุฑูุฑ ุงููุฏููุนุงุช ุงูุดุงูู")
        ูุงูุฐุฉ_ุชูุฑูุฑ.geometry("700x600")
        
        # ุฌุนู ุงููุงูุฐุฉ ูู ุงูููุชุตู
        ูุงูุฐุฉ_ุชูุฑูุฑ.transient(self.ูุงูุฐุฉ)
        ูุงูุฐุฉ_ุชูุฑูุฑ.grab_set()
        
        # ุฅุทุงุฑ ุงูุชูุฑูุฑ
        ุฅุทุงุฑ_ุชูุฑูุฑ = ttk.Frame(ูุงูุฐุฉ_ุชูุฑูุฑ)
        ุฅุทุงุฑ_ุชูุฑูุฑ.pack(fill="both", expand=True, padx=20, pady=20)
        
        canvas = tk.Canvas(ุฅุทุงุฑ_ุชูุฑูุฑ)
        ุดุฑูุท_ุชูุฑูุฑ = ttk.Scrollbar(ุฅุทุงุฑ_ุชูุฑูุฑ, orient="vertical", command=canvas.yview)
        ุฅุทุงุฑ_ูุงุจู_ููุชูุฑูุฑ = ttk.Frame(canvas)
        
        ุฅุทุงุฑ_ูุงุจู_ููุชูุฑูุฑ.bind("<Configure>", lambda e: canvas.configure(scrollregion=canvas.bbox("all")))
        canvas.create_window((0, 0), window=ุฅุทุงุฑ_ูุงุจู_ููุชูุฑูุฑ, anchor="nw")
        canvas.configure(yscrollcommand=ุดุฑูุท_ุชูุฑูุฑ.set)
        
        canvas.pack(side="left", fill="both", expand=True)
        ุดุฑูุท_ุชูุฑูุฑ.pack(side="right", fill="y")
        
        # ุนุฑุถ ุงูุชูุงุฑูุฑ
        ttk.Label(ุฅุทุงุฑ_ูุงุจู_ููุชูุฑูุฑ, text="๐ ุชูุฑูุฑ ุงููุฏููุนุงุช ุงูุดุงูู", font=('Arial', 18, 'bold')).pack(pady=15)
        
        # ุงูุฅุญุตุงุฆูุงุช ุงููุงููุฉ
        self.ุนุฑุถ_ูุณู_ุชูุฑูุฑ(ุฅุทุงุฑ_ูุงุจู_ููุชูุฑูุฑ, "๐ฐ ุงูุฅุญุตุงุฆูุงุช ุงููุงููุฉ", ุชูุงุฑูุฑ['ุฅุญุตุงุฆูุงุช_ูุงููุฉ'])
        
        # ุชุญููู ุงูุญุงูุฉ
        self.ุนุฑุถ_ูุณู_ุชูุฑูุฑ(ุฅุทุงุฑ_ูุงุจู_ููุชูุฑูุฑ, "๐ฏ ุชุญููู ุญุงูุฉ ุงููุฏููุนุงุช", ุชูุงุฑูุฑ['ุชุญููู_ุงูุญุงูุฉ'])
        
        # ุงูุชูุฒูุน ุญุณุจ ุงููุฆุฉ
        self.ุนุฑุถ_ูุณู_ุชูุฑูุฑ(ุฅุทุงุฑ_ูุงุจู_ููุชูุฑูุฑ, "๐ ุงูุชูุฒูุน ุญุณุจ ุงููุฆุฉ", ุชูุงุฑูุฑ['ุชูุฒูุน_ุงููุฆุงุช'])
        
        # ุงููุฏููุนุงุช ุงููุชุฃุฎุฑุฉ
        if ุชูุงุฑูุฑ['ูุฏููุนุงุช_ูุชุฃุฎุฑุฉ']:
            self.ุนุฑุถ_ูุณู_ุชูุฑูุฑ(ุฅุทุงุฑ_ูุงุจู_ููุชูุฑูุฑ, "๐ ุงููุฏููุนุงุช ุงููุชุฃุฎุฑุฉ", ุชูุงุฑูุฑ['ูุฏููุนุงุช_ูุชุฃุฎุฑุฉ'])

    def ุญุณุงุจ_ุชูุงุฑูุฑ_ุงูุฏูุน(self):
        """ุญุณุงุจ ุชูุงุฑูุฑ ุงูุฏูุน ุงูุดุงููุฉ"""
        ุงูููู = datetime.now()
        
        # ุงูุฅุญุตุงุฆูุงุช ุงููุงููุฉ
        ุฅุญุตุงุฆูุงุช = self.ุญุณุงุจ_ุงูุฅุญุตุงุฆูุงุช_ุงููุงููุฉ()
        
        # ุชุญููู ุงูุญุงูุฉ
        ุญุงูุงุช = {'ูุดุท': 0, 'ูุฑูุจ': 0, 'ุนุงุฌู': 0, 'ูุชุฃุฎุฑ': 0}
        for ุงุดุชุฑุงู in self.ุงูุจูุงูุงุช:
            try:
                ุชุงุฑูุฎ_ุฏูุน = datetime.strptime(ุงุดุชุฑุงู['ุชุงุฑูุฎ_ุงูุฏูุน'], '%Y-%m-%d')
                ุฃูุงู_ูุชุจููุฉ = (ุชุงุฑูุฎ_ุฏูุน - ุงูููู).days
                
                if ุฃูุงู_ูุชุจููุฉ < 0:
                    ุญุงูุงุช['ูุชุฃุฎุฑ'] += 1
                elif ุฃูุงู_ูุชุจููุฉ == 0:
                    ุญุงูุงุช['ุนุงุฌู'] += 1
                elif ุฃูุงู_ูุชุจููุฉ <= 7:
                    ุญุงูุงุช['ูุฑูุจ'] += 1
                else:
                    ุญุงูุงุช['ูุดุท'] += 1
            except:
                pass
        
        # ุงูุชูุฒูุน ุญุณุจ ุงููุฆุฉ
        ุชูุฒูุน_ุงููุฆุงุช = {}
        for ุงุดุชุฑุงู in self.ุงูุจูุงูุงุช:
            ูุฆุฉ = ุงุดุชุฑุงู['ูุฆุฉ']
            ุชูุฒูุน_ุงููุฆุงุช[ูุฆุฉ] = ุชูุฒูุน_ุงููุฆุงุช.get(ูุฆุฉ, 0) + 1
        
        # ุงููุฏููุนุงุช ุงููุชุฃุฎุฑุฉ
        ูุฏููุนุงุช_ูุชุฃุฎุฑุฉ = []
        for ุงุดุชุฑุงู in self.ุงูุจูุงูุงุช:
            try:
                ุชุงุฑูุฎ_ุฏูุน = datetime.strptime(ุงุดุชุฑุงู['ุชุงุฑูุฎ_ุงูุฏูุน'], '%Y-%m-%d')
                if ุชุงุฑูุฎ_ุฏูุน < ุงูููู:
                    ุฃูุงู_ุชุฃุฎุฑ = (ุงูููู - ุชุงุฑูุฎ_ุฏูุน).days
                    ูุฏููุนุงุช_ูุชุฃุฎุฑุฉ.append(f"{ุงุดุชุฑุงู['ุงุณู']}: {ุฃูุงู_ุชุฃุฎุฑ} ููู ({ุงุดุชุฑุงู['ุณุนุฑ']:.2f} $)")
            except:
                pass
        
        return {
            'ุฅุญุตุงุฆูุงุช_ูุงููุฉ': [
                f"ุฅุฌูุงูู ุงูุงุดุชุฑุงูุงุช: {len(self.ุงูุจูุงูุงุช)}",
                f"ุฅุฌูุงูู ุงููุฏููุนุงุช ุงูุดูุฑูุฉ: {ุฅุญุตุงุฆูุงุช['ุฅุฌูุงูู_ุงููุฏููุนุงุช']:.2f} $",
                f"ุงููุณุชุญู ูุฐุง ุงูุดูุฑ: {ุฅุญุตุงุฆูุงุช['ุงููุณุชุญู_ูุฐุง_ุงูุดูุฑ']:.2f} $",
                f"ุงููุชุฃุฎุฑ ูู ุงูุณุฏุงุฏ: {ุฅุญุตุงุฆูุงุช['ุงููุชุฃุฎุฑ_ูู_ุงูุณุฏุงุฏ']:.2f} $",
                f"ุงูุชูููุฉ ุงูุณูููุฉ: {ุฅุญุตุงุฆูุงุช['ุฅุฌูุงูู_ุงููุฏููุนุงุช'] * 12:.2f} $"
            ],
            'ุชุญููู_ุงูุญุงูุฉ': [
                f"โ ูุดุท: {ุญุงูุงุช['ูุดุท']}",
                f"๐ถ ูุฑูุจ: {ุญุงูุงุช['ูุฑูุจ']}",
                f"โ๏ธ ุนุงุฌู: {ุญุงูุงุช['ุนุงุฌู']}",
                f"๐ ูุชุฃุฎุฑ: {ุญุงูุงุช['ูุชุฃุฎุฑ']}"
            ],
            'ุชูุฒูุน_ุงููุฆุงุช': [f"{ูุฆุฉ}: {ุนุฏุฏ}" for ูุฆุฉ, ุนุฏุฏ in ุชูุฒูุน_ุงููุฆุงุช.items()],
            'ูุฏููุนุงุช_ูุชุฃุฎุฑุฉ': ูุฏููุนุงุช_ูุชุฃุฎุฑุฉ
        }

    def ุนุฑุถ_ูุณู_ุชูุฑูุฑ(self, parent, ุนููุงู, ูุญุชููุงุช):
        """ุนุฑุถ ูุณู ูู ุงูุชูุฑูุฑ"""
        ุฅุทุงุฑ_ูุณู = ttk.LabelFrame(parent, text=ุนููุงู, padding=12)
        ุฅุทุงุฑ_ูุณู.pack(fill="x", pady=10)
        
        for ูุญุชูู in ูุญุชููุงุช:
            ttk.Label(ุฅุทุงุฑ_ูุณู, text=ูุญุชูู, font=('Arial', 10)).pack(anchor='w', pady=3)

    def ุชุญููู_ุงูุจูุงูุงุช(self):
        """ุชุญููู ุงูุจูุงูุงุช ูู ุงูููู"""
        if os.path.exists(self.ููู_ุงูุจูุงูุงุช):
            try:
                with open(self.ููู_ุงูุจูุงูุงุช, 'r', encoding='utf-8') as ููู:
                    return json.load(ููู)
            except Exception as e:
                messagebox.showerror("ุฎุทุฃ", f"ุฎุทุฃ ูู ุชุญููู ุงูุจูุงูุงุช: {e}")
                return []
        else:
            # ุจูุงูุงุช ุชุฌุฑูุจูุฉ ุชุฑูุฒ ุนูู ุงูุฏูุน
            return [
                {
                    "ุงุณู": "ููุชููููุณ",
                    "ุณุนุฑ": 45,
                    "ุชุงุฑูุฎ_ุงูุฏูุน": (datetime.now() + timedelta(days=5)).strftime('%Y-%m-%d'),
                    "ุฏูุฑุฉ_ุงูุฏูุน": "ุดูุฑู",
                    "ุทุฑููุฉ_ุงูุฏูุน": "ุจุทุงูุฉ ุงุฆุชูุงู",
                    "ูุฆุฉ": "ุชุฑููู",
                    "ููุงุญุธุงุช": "ุจุงูุฉ ุจุฑููููู - ุชุฌุฏูุฏ ุชููุงุฆู",
                    "ุชุงุฑูุฎ_ุงูุชุณุฌูู": datetime.now().strftime('%Y-%m-%d %H:%M:%S'),
                    "ุญุงูุฉ_ุงูุฏูุน": "ูุดุท"
                },
                {
                    "ุงุณู": "ููุชููุจ ุจุฑููููู",
                    "ุณุนุฑ": 35,
                    "ุชุงุฑูุฎ_ุงูุฏูุน": (datetime.now() + timedelta(days=12)).strftime('%Y-%m-%d'),
                    "ุฏูุฑุฉ_ุงูุฏูุน": "ุดูุฑู",
                    "ุทุฑููุฉ_ุงูุฏูุน": "PayPal",
                    "ูุฆุฉ": "ุชุฑููู",
                    "ููุงุญุธุงุช": "ููุณููู ุจุฏูู ุฅุนูุงูุงุช",
                    "ุชุงุฑูุฎ_ุงูุชุณุฌูู": datetime.now().strftime('%Y-%m-%d %H:%M:%S'),
                    "ุญุงูุฉ_ุงูุฏูุน": "ูุดุท"
                }
            ]

    def ุญูุธ_ุงูุจูุงูุงุช(self):
        """ุญูุธ ุงูุจูุงูุงุช ูู ุงูููู"""
        try:
            with open(self.ููู_ุงูุจูุงูุงุช, 'w', encoding='utf-8') as ููู:
                json.dump(self.ุงูุจูุงูุงุช, ููู, ensure_ascii=False, indent=2)
        except Exception as e:
            messagebox.showerror("ุฎุทุฃ", f"ุฎุทุฃ ูู ุญูุธ ุงูุจูุงูุงุช: {e}")

if __name__ == "__main__":
    try:
        # ุฅุนุฏุงุฏ ุงููุงูุฐุฉ ุงูุฑุฆูุณูุฉ
        ูุงูุฐุฉ_ุฑุฆูุณูุฉ = tk.Tk()
        
        # ุชุญุณูู ูุธูุฑ ุงูุชุทุจูู ููุชูุงุณุจ ูุน Windows
        ููุท = ttk.Style()
        ููุท.theme_use('vista')  # ุงุณุชุฎุฏุงู ุณูุฉ Vista ุงูุชู ุชุฃุชู ูุน Windows
        
        # ุฌุนู ุงูุชุทุจูู ูุธูุฑ ูู ุดุฑูุท ุงูููุงู
        ูุงูุฐุฉ_ุฑุฆูุณูุฉ.iconbitmap(default='')  # ูููู ุฅุถุงูุฉ ุฃููููุฉ ููุง ุฅุฐุง ุฑุบุจุช
        
        ุชุทุจูู = ูุฏูุฑ_ุงูุงุดุชุฑุงูุงุช_ุงููุญุณู(ูุงูุฐุฉ_ุฑุฆูุณูุฉ)
        
        # ุฅุถุงูุฉ ุงุฎุชุตุงุฑ ููุญุฉ ุงูููุงุชูุญ (Ctrl+Q ููุฅุบูุงู)
        ูุงูุฐุฉ_ุฑุฆูุณูุฉ.bind('<Control-q>', lambda e: ูุงูุฐุฉ_ุฑุฆูุณูุฉ.quit())
        
        # ุชุดุบูู ุงูุชุทุจูู
        ูุงูุฐุฉ_ุฑุฆูุณูุฉ.mainloop()
        
    except Exception as e:
        print(f"ุญุฏุซ ุฎุทุฃ: {e}")
        messagebox.showerror("ุฎุทุฃ ุชุดุบูู", f"ุญุฏุซ ุฎุทุฃ ุฃุซูุงุก ุชุดุบูู ุงูุชุทุจูู: {e}")
